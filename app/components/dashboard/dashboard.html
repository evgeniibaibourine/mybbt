<!-- Main section-->
<section class="section-container">
    <!-- Page content-->
    <div class="content-wrapper">
        <div class="content-heading">
            <div><b>Dashboard</b></div>
        </div>

        <div class="row">
            <div class="col-xl-4">
                <!-- START List group-->
                <div class="list-group mb-3">
                    <div class="list-group-item">
                        <div class="d-flex align-items-center py-3">
                            <div class="w-50 px-3">
                                <p class="m-0 lead">1204</p>
                                <p class="m-0 text-sm">Commits this month</p>
                            </div>
                            <div class="w-50 px-3 text-center">
                                <div data-sparkline="" data-bar-color="#23b7e5" data-height="60" data-bar-width="10" data-bar-spacing="6" data-chart-range-min="0" data-values="3,6,7,8,4,5"></div>
                            </div>
                        </div>
                    </div>
                    <div class="list-group-item">
                        <div class="d-flex align-items-center py-3">
                            <div class="w-50 px-3">
                                <p class="m-0 lead">$ 3,200.00</p>
                                <p class="m-0 text-sm">Available budget</p>
                            </div>
                            <div class="w-50 px-3 text-center">
                                <div data-sparkline="" data-type="line" data-height="60" data-width="80%" data-line-width="2" data-line-color="#7266ba" data-chart-range-min="0" data-spot-color="#888" data-min-spot-color="#7266ba" data-max-spot-color="#7266ba" data-fill-color="" data-highlight-line-color="#fff"
                                    data-spot-radius="3" data-values="7,3,4,7,5,9,4,4,7,5,9,6,4" data-resize="true"></div>
                            </div>
                        </div>
                    </div>
                    <div class="list-group-item">
                        <div class="d-flex align-items-center py-3">
                            <div class="w-50 px-3">
                                <p class="m-0 lead">67</p>
                                <p class="m-0 text-sm">New followers</p>
                            </div>
                            <div class="w-50 px-3 text-center">
                                <div class="d-flex align-items-center flex-wrap justify-content-center">
                                    <!-- <a href="#" data-toggle="tooltip" title="Katie">
                                     <img class="circle thumb24 mx-1" src="img/user/02.jpg" alt="Follower">
                                  </a>
                                  <a href="#" data-toggle="tooltip" title="Cody">
                                     <img class="circle thumb24 mx-1" src="img/user/01.jpg" alt="Follower">
                                  </a>
                                  <a href="#" data-toggle="tooltip" title="Tamara">
                                     <img class="circle thumb24 mx-1" src="img/user/03.jpg" alt="Follower">
                                  </a>
                                  <a href="#" data-toggle="tooltip" title="Gene">
                                     <img class="circle thumb24 mx-1" src="img/user/04.jpg" alt="Follower">
                                  </a>
                                  <a href="#" data-toggle="tooltip" title="Marsha">
                                     <img class="circle thumb24 mx-1" src="img/user/04.jpg" alt="Follower">
                                  </a>
                                  <a href="#" data-toggle="tooltip" title="Robin">
                                     <img class="circle thumb24 mx-1" src="img/user/09.jpg" alt="Follower">
                                  </a> -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- END List group-->
            </div>
            <div class="col-xl-8">
                <!-- START USA Map-->
                <div class="card" id="cardChart3">
                    <div class="card-header">
                        <div class="card-title">USA</div>
                    </div>
                    <div class="card-wrapper">
                        <div class="card-body">
                            <div id="chartdiv"></div>
                        </div>
                    </div>
                </div>
                <!-- END USA Map-->
            </div>
        </div>

        <!-- DATATABLE-->
        <!-- START Datatable-->
        <div class="row">
            <div class="col-xl-12">
                <!-- START card-->
                <div class="card card-default card-demo" id="cardChart1">
                    <div class="card-header">
                        <div class="card-title">Temple Details</div>
                    </div>
                    <div class="card-wrapper collapse show">
                        <div class="card-body">
                            <div class="col-3">
                                <span class="dt-month-switch">Showing 
                                <select class="custom-select custom-select-md month-switcher-select" ng-init="selectedTempleDetailsMonth = monthArray[monthArray.length - 1]" ng-model="selectedTempleDetailsMonth" ng-options="month for month in monthArray" ng-change="monthSwitcher(selectedTempleDetailsMonth)">
                                </select> details</span>
                            </div>
                            <table datatable="ng" class="table table-striped table-hover my-4 w-100" dt-options="dtOptions" id="templeDetails">
                                <thead>
                                    <tr>
                                        <th data-priority="1">Temple</th>
                                        <th>2018 Goal</th>
                                        <th>2018 Remittance YTD</th>
                                        <th>YTD Progress</th>
                                        <th>Current Month Remittance</th>
                                        <th>2018 Monthly Goal</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="detail in templeDetails" ng-click="openTempleDetails(detail)" ng-if="detail.yearlyRemittance != 0">
                                        <td data-priority="1">{{detail.temple}}</td>
                                        <td>{{detail.yearlyGoal}}</td>
                                        <td>{{detail.yearlyRemittance}}</td>
                                        <td>
                                            <div class="progress progress-xs m-0" tooltips tooltip-template="{{detail.remittanceProgress | number: 2}}%">
                                                <div class="progress-bar progress-bar-striped" ng-class="progressColor({{detail.remittanceProgress | number: 2}})" role="progressbar" aria-valuenow="{{detail.remittanceProgress | number: 2}}" aria-valuemin="0" aria-valuemax="100" style="width: {{detail.remittanceProgress | number: 2}}%">
                                                </div>
                                            </div>
                                        </td>
                                        <td>{{detail.currentRemittance}}</td>
                                        <td>{{detail.monthlyGoal | number: 2}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- END card-->
            </div>
        </div>
        <!-- END Datatable-->

        <!-- Chart Starts Here -->
        <div class="row">
            <div class="col-xl-6">
                <!-- START card-->
                <div class="card card-default card-demo" id="cardChart2">
                    <div class="card-header">
                        <div class="card-title">Current Remittance</div>
                    </div>
                    <div class="card-wrapper collapse show">
                        <div class="card-body">
                            <canvas id="pie" class="chart chart-pie" ng-if="pieData" chart-legend="true" chart-colors="pieColors" chart-data="pieData" chart-labels="pieLabels" chart-options="pieOptions" style="height: 250px"></canvas>
                        </div>
                    </div>
                </div>
                <!-- END card-->
            </div>

            <div class="col-xl-6">
                <!-- START card-->
                <div class="card card-default card-demo" id="cardChart3">
                    <div class="card-header">
                        <div class="card-title">Yearly Remittance</div>
                    </div>
                    <div class="card-wrapper collapse show">
                        <div class="card-body">
                            <canvas id="line" class="chart chart-line" chart-colors="lineColors" chart-data="lineData" chart-labels="lineLabels" chart-series="lineSeries" chart-options="lineOptions" style="height: 250px"></canvas>
                        </div>
                    </div>
                </div>
                <!-- END card-->
            </div>
        </div>
        <!-- Chart Ends Here -->
    </div>
</section>

<!-- Chart code -->
<script>
    var latlong = {};
    latlong["US"] = {
        "latitude": 38,
        "longitude": -97
    };

    var mapData = [{
        "code": "US",
        "name": "United States",
        "value": 43313085380,
        "color": "#a7a737"
    }];


    // get min and max values
    var minBulletSize = 3;
    var maxBulletSize = 70;
    var min = Infinity;
    var max = -Infinity;
    for (var i = 0; i < mapData.length; i++) {
        var value = mapData[i].value;
        if (value < min) {
            min = value;
        }
        if (value > max) {
            max = value;
        }
    }

    // it's better to use circle square to show difference between values, not a radius
    var maxSquare = maxBulletSize * maxBulletSize * 2 * Math.PI;
    var minSquare = minBulletSize * minBulletSize * 2 * Math.PI;

    // create circle for each country
    var images = [];
    for (var i = 0; i < mapData.length; i++) {
        var dataItem = mapData[i];
        var value = dataItem.value;
        // calculate size of a bubble
        var square = (value - min) / (max - min) * (maxSquare - minSquare) + minSquare;
        if (square < minSquare) {
            square = minSquare;
        }
        var size = Math.sqrt(square / (Math.PI * 2));
        var id = dataItem.code;

        images.push({
            "type": "circle",
            "theme": "none",
            "width": size,
            "height": size,
            "color": dataItem.color,
            "longitude": latlong[id].longitude,
            "latitude": latlong[id].latitude,
            "title": dataItem.name,
            "value": value
        });
    }

    // build map
    /* var map = AmCharts.makeChart("chartdiv", {
        "type": "map",
        "projection": "eckert6",
        "titles": [{
            "text": "Population of the World in 2011",
            "size": 14
        }, {
            "text": "source: Gapminder",
            "size": 11
        }],
        "areasSettings": {
            //"unlistedAreasColor": "#000000",
            //"unlistedAreasAlpha": 0.1
        },
        "dataProvider": {
            "map": "worldLow",
            "images": images
        },
        "export": {
            "enabled": false
        }
    }); */

    // ===================================== USA MAP STARTS FROM HERE ==================================//

    var map = AmCharts.makeChart("chartdiv", {
        "type": "map",
        "theme": "light",
        "titles": [{
            "text": "Remittances in USA",
            "size": 14
        }],

        "dataProvider": {
            "map": "usaLow",
            "images": images,
            "areas": [{
                "id": "US-AL"
            }, {
                "id": "US-AK"
            }, {
                "id": "US-AZ"
            }, {
                "id": "US-AR"
            }, {
                "id": "US-CA"
            }, {
                "id": "US-CO"
            }, {
                "id": "US-CT"
            }, {
                "id": "US-DE"
            }, {
                "id": "US-FL"
            }, {
                "id": "US-GA"
            }, {
                "id": "US-HI"
            }, {
                "id": "US-ID"
            }, {
                "id": "US-IL"
            }, {
                "id": "US-IN"
            }, {
                "id": "US-IA"
            }, {
                "id": "US-KS"
            }, {
                "id": "US-KY"
            }, {
                "id": "US-LA"
            }, {
                "id": "US-ME"
            }, {
                "id": "US-MD"
            }, {
                "id": "US-MA"
            }, {
                "id": "US-MI"
            }, {
                "id": "US-MN"
            }, {
                "id": "US-MS"
            }, {
                "id": "US-MO"
            }, {
                "id": "US-MT"
            }, {
                "id": "US-NE"
            }, {
                "id": "US-NV"
            }, {
                "id": "US-NH"
            }, {
                "id": "US-NJ"
            }, {
                "id": "US-NM"
            }, {
                "id": "US-NY"
            }, {
                "id": "US-NC"
            }, {
                "id": "US-ND"
            }, {
                "id": "US-OH"
            }, {
                "id": "US-OK"
            }, {
                "id": "US-OR"
            }, {
                "id": "US-PA"
            }, {
                "id": "US-RI"
            }, {
                "id": "US-SC"
            }, {
                "id": "US-SD"
            }, {
                "id": "US-TN"
            }, {
                "id": "US-TX"
            }, {
                "id": "US-UT"
            }, {
                "id": "US-VT"
            }, {
                "id": "US-VA"
            }, {
                "id": "US-WA"
            }, {
                "id": "US-WV"
            }, {
                "id": "US-WI"
            }, {
                "id": "US-WY"
            }]
        },

        "areasSettings": {
            "autoZoom": true
        },

        "export": {
            "enabled": false
        }

    });
</script>